(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[7],{297:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"e",(function(){return O}));var c=n(8),i=n(13),r=n(308),o=n(26),a=n(147),s=n(43),d=n(81),u=n(21);function l(){var e,t=Object(u.c)(),n=Object(i.a)(t,1)[0].user,r=Object(a.a)({queryKey:["like-items",null===n||void 0===n?void 0:n._id],queryFn:function(){return o.c.get("/".concat(null===n||void 0===n?void 0:n._id,"/likes")).then((function(e){return e.data.data.likes})).catch((function(e){throw e.response.data}))}});return Object(c.a)(Object(c.a)({},r),{},{likeItems:null!==(e=r.data)&&void 0!==e?e:[]})}function j(e){var t,n=Object(u.c)();return Object(i.a)(n,1)[0].user&&null!==(t=l().likeItems.find((function(t){return t.videoId===e})))&&void 0!==t?t:null}function b(e){var t=Object(u.c)(),n=Object(i.a)(t,1)[0].user,r=Object(s.b)(),a=Object(d.a)((function(e){return o.c.post("/".concat(null===n||void 0===n?void 0:n._id,"/likes"),{videoId:e.videoId,title:e.title,channelTitle:e.channel.title,image:e.images,publishedAt:e.publishedAt})}),{onSettled:function(){r.invalidateQueries(["like-items",null===n||void 0===n?void 0:n._id]),r.invalidateQueries(["videoInfo",{videoId:e}])},onError:function(e,t,n){"function"===typeof n&&n()},onMutate:function(){var t=r.getQueryData(["videoInfo",{videoId:e}]);return r.setQueryData(["videoInfo",{videoId:e}],(function(e){return Object(c.a)(Object(c.a)({},e),{},{likes:e.likes+1})})),function(){return r.setQueryData(["videoInfo",{videoId:e}],t)}}});return Object(c.a)(Object(c.a)({},a),{},{createLike:a.mutateAsync})}function m(){var e=Object(u.c)(),t=Object(i.a)(e,1)[0].user,n=Object(s.b)(),a=Object(d.a)((function(e){var n=e.videoId;return o.c.delete("/".concat(null===t||void 0===t?void 0:t._id,"/likes/").concat(n))}),{onSettled:function(){n.invalidateQueries(["like-items",null===t||void 0===t?void 0:t._id])},onError:function(e,t,n){"function"===typeof n&&n()},onMutate:function(e){var c=e.videoId,i=n.getQueryData(["like-items",null===t||void 0===t?void 0:t._id]);return n.setQueryData(["like-items",null===t||void 0===t?void 0:t._id],(function(e){return r.a((function(e){return e.videoId===c}),e)})),function(){return n.setQueryData(["like-items",null===t||void 0===t?void 0:t._id],i)}}});return Object(c.a)(Object(c.a)({},a),{},{removeLike:a.mutateAsync})}function O(e){var t=Object(u.c)(),n=Object(i.a)(t,1)[0].user,r=Object(s.b)(),a=Object(d.a)((function(e){var t=e.videoId;return o.c.delete("/".concat(null===n||void 0===n?void 0:n._id,"/likes/").concat(t))}),{onSettled:function(){r.invalidateQueries(["like-items",null===n||void 0===n?void 0:n._id]),r.invalidateQueries(["videoInfo",{videoId:e}])},onError:function(e,t,n){"function"===typeof n&&n()},onMutate:function(){var t=r.getQueryData(["videoInfo",{videoId:e}]);return r.setQueryData(["videoInfo",{videoId:e}],(function(e){if(e)return Object(c.a)(Object(c.a)({},e),{},{likes:e.likes-1})})),function(){return r.setQueryData(["videoInfo",{videoId:e}],t)}}});return Object(c.a)(Object(c.a)({},a),{},{removeLike:a.mutateAsync})}},328:function(e,t,n){"use strict";n.r(t);var c=n(18),i=n(13),r=n(3),o=n(0),a=n(17),s=n(20),d=n(102),u=n(107),l=n(297),j=n(54),b=n(4),m=n(6),O=n(1),f=n(21),v=n(8),h=n(308),x=n(26),p=n(147),I=n(43),y=n(81),_=n(47);function k(e){var t=Object(I.b)();return{onSettled:function(){return t.invalidateQueries(["commentSearch",{videoId:e}])}}}var g=n(101),w=n(319),C=n(320),S=n(262),Q=n(321),N=n(335),A=n(333),D=Object(o.createContext)(),L=function(e){var t=e.children,n=Object(o.useState)(!1),c=Object(i.a)(n,2),a={isOpen:c[0],setIsOpen:c[1],anchorRef:Object(o.useRef)(null)};return Object(r.jsx)(D.Provider,{value:a,children:t})},q=function(e){var t=e.children,n=Object(o.useContext)(D),c=n.setIsOpen,i=n.anchorRef;return Object(o.cloneElement)(t,{onClick:R((function(){return c(!0)}),t.props.onClick),ref:i})},E=function(e){var t=e.children,n=Object(o.useContext)(D),c=n.setIsOpen,i=n.anchorRef;return Object(o.cloneElement)(t,{onClick:R((function(){return c(!1)}),t.props.onClick),ref:i})},M=function(e){var t=e.children,n=(e.className,Object(o.useContext)(D)),c=n.isOpen,i=n.setIsOpen,a=n.anchorRef,s=function(e){a.current&&a.current.contains(e.target)||i(!1)};return Object(r.jsx)(w.a,{open:c,anchorEl:a.current,transition:!0,children:function(e){var n=e.TransitionProps,i=e.placement;return Object(r.jsx)(C.a,Object(v.a)(Object(v.a)({},n),{},{style:{transformOrigin:"bottom"===i?"center top":"center bottom"},children:Object(r.jsx)(S.a,{children:Object(r.jsx)(Q.a,{onClickAway:s,children:Object(r.jsx)(N.a,{autoFocusItem:c,children:t})})})}))}})};function R(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];t.forEach((function(e){e&&e.apply(void 0,n)}))}}var T=n(322);function F(){var e=Object(c.a)(["\n   &:not(:last-child) {\n      margin-bottom: 3rem;\n   }\n"]);return F=function(){return e},e}var P=Object(b.c)((function(e){var t=e.comment,n=e.setCurrentTypedComment,c=e.className,o=Object(a.i)().videoId,s=Object(f.c)(),d=Object(i.a)(s,1)[0].user,u=function(e,t){var n=k(e),c=Object(y.a)((function(t){var n=t.commentId;return x.d.delete("/".concat(e,"/comments/").concat(n))}),Object(v.a)(Object(v.a)(Object(v.a)({},n),t),{},{onMutate:function(t){var n=t.commentId;_.b.setQueryData(["commentSearch",{videoId:e}],(function(e){return h.a((function(e){return e._id===n}),e)}))}}));return Object(v.a)(Object(v.a)({},c),{},{remove:c.mutate})}(o).remove;return Object(r.jsxs)(m.o,{flexy:"center",className:c,children:[Object(r.jsx)(m.o.Item,{width:"5",children:Object(r.jsx)(m.j,{children:Object(r.jsx)(m.i,{modifiers:"round",src:"".concat("https://simulate-youtube-project.herokuapp.com","/").concat(t.user.photo),alt:"User Image"})})}),Object(r.jsxs)(m.o.Item,{width:"85",spacing:"2.5",children:[Object(r.jsx)(m.q,{modifiers:["small","bold"],children:t.user.name}),Object(r.jsx)(m.q,{modifiers:"small",children:t.comment})]}),d&&d._id===t.user._id?function(e){return Object(r.jsx)(m.o.Item,{children:Object(r.jsxs)(L,{children:[Object(r.jsx)(q,{children:Object(r.jsx)(m.a,{modifiers:"transparent",children:Object(r.jsx)(m.h,{as:T.a})})}),Object(r.jsxs)(M,{children:[Object(r.jsx)(E,{children:Object(r.jsx)(A.a,{onClick:function(){return n(e)},children:"Edit"})}),Object(r.jsx)(E,{children:Object(r.jsx)(A.a,{onClick:function(){return u({commentId:e._id})},children:"Delete"})})]})]})})}(t):null]})}))(F()),J=n(36);function K(){var e=Object(c.a)(["\n   margin-top: 5rem;\n\n   .comment {\n      &__form {\n         margin: 3rem 0;\n      }\n\n      &__submitbox {\n         margin-top: 1rem;\n         display: flex;\n         justify-content: flex-end;\n      }\n   }\n"]);return K=function(){return e},e}var U=Object(b.c)((function(e){var t,n=e.className,c=Object(f.c)(),s=Object(i.a)(c,1)[0].user,d=Object(a.i)().videoId,u=Object(g.a)(),l=u.register,b=u.handleSubmit,O=u.setValue,h=u.reset,I=Object(o.useState)(null),_=Object(i.a)(I,2),w=_[0],C=_[1],S=function(e){var t=Object(p.a)({queryKey:["commentSearch",{videoId:e}],queryFn:function(){return x.d.get("/".concat(e,"/comments")).then((function(e){return e.data.data.doc})).catch((function(e){throw e.response.data}))}});return Object(v.a)(Object(v.a)({},t),{},{comments:t.data})}(d),Q=S.comments,N=S.isIdle,A=S.isLoading,D=S.isSuccess,L=Object(j.a)(),q=L.isLoading,E=L.run,M=function(e,t){var n=k(e),c=Object(y.a)((function(t){return x.d.post("/".concat(e,"/comments"),t)}),Object(v.a)(Object(v.a)({},n),t));return Object(v.a)(Object(v.a)({},c),{},{create:c.mutateAsync})}(d).create,R=function(e,t){var n=k(e),c=Object(y.a)((function(t){var n=t.commentId,c=t.comment;return x.d.patch("/".concat(e,"/comments/").concat(n),c)}),Object(v.a)(Object(v.a)({},n),t));return Object(v.a)(Object(v.a)({},c),{},{update:c.mutateAsync})}(d).update;return Object(o.useEffect)((function(){w&&O("comment",w.comment)}),[w,O]),N||A||q?Object(r.jsx)(J.a,{}):D?Object(r.jsxs)("div",{className:n,children:[s?Object(r.jsxs)(m.f,{className:"comment__form",onSubmit:b((function(e){E(w?R({commentId:w._id,comment:e}):M(e)),C(null)})),children:[Object(r.jsx)(m.k,{modifiers:"transparent",type:"text",name:"comment",placeholder:"Add a public comment...",ref:l({required:"Please type your comment"})}),Object(r.jsxs)("div",{className:"comment__submitbox",children:[Object(r.jsx)(m.a,{onClick:function(){h(),C(null)},children:"Cancel"}),Object(r.jsx)(m.a,{modifiers:"secondary",children:"Comment"})]})]}):null,Object(r.jsx)("div",{children:(t=Q,null===t||void 0===t?void 0:t.map((function(e){return Object(r.jsx)(P,{comment:e,setCurrentTypedComment:C},e._id)})))})]}):void 0}))(K()),V=n(290);function z(){var e=Object(c.a)(["\n   .video {\n      width: 80%;\n      margin: 0 auto;\n      padding: 2rem 0rem;\n      ","\n\n      &__videobox {\n         box-shadow: var(--shadow-dark-shallow);\n         height: 37.5vw;\n         ","\n      }\n\n      &__titlebox {\n         border-bottom: solid 0.1rem #000;\n         padding: 2rem 1rem;\n      }\n\n      &__subscribebtn {\n         flex: 0 0 15%;\n         margin-left: 2.5%;\n      }\n\n      &__info {\n         padding: 2rem 0;\n         border-bottom: solid 0.1rem #000;\n      }\n   }\n"]);return z=function(){return e},e}t.default=Object(b.c)((function(e){var t,n=e.history,c=e.className,b=Object(f.c)(),O=Object(i.a)(b,1)[0].user,v=Object(a.i)().videoId,h=Object(d.c)(v),x=h.video,p=h.isIdle,I=h.isLoading,y=h.isSuccess,_=Object(l.b)(v),k=Object(j.a)(),g=k.isLoading,w=k.run,C=Object(u.b)(v).createSubscribe,S=Object(u.d)(v).removeSubscribe,Q=Object(l.a)(v).createLike,N=Object(l.e)(v).removeLike,A=Object(u.e)((null===x||void 0===x||null===(t=x.channel)||void 0===t?void 0:t._id)||null),D=Object(o.useState)(!1),L=Object(i.a)(D,2),q=L[0],E=L[1],M="https://www.youtube.com/embed/".concat(v);function R(e){return function(){w(e())}}return p||I?Object(r.jsx)(m.c,{width:"10",children:Object(r.jsx)(J.a,{})}):y?Object(r.jsx)(m.c,{width:"10",className:c,children:Object(r.jsxs)("div",{className:"video",children:[Object(r.jsx)("div",{className:"video__videobox",children:Object(r.jsx)(m.u,{src:M,title:"video player"})}),Object(r.jsxs)(m.o,{flexy:"center",className:"video__titlebox",children:[Object(r.jsxs)(m.o.Item,{width:"70",children:[Object(r.jsx)(m.t,{modifiers:"medium",children:x.title}),Object(r.jsxs)(m.q,{modifiers:"small",children:[new Date(x.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})," ","\u2022 ",x.views," views"]})]}),Object(r.jsxs)(m.o.Item,{flexy:"center",children:[Object(r.jsx)(m.a,{modifiers:"transparent",pd:"0",onClick:O?_?function(){return N({videoId:v})}:function(){return Q(x)}:function(){return n.push("/login")},children:Object(r.jsx)(m.h,{as:V.a,modifiers:"".concat(_?"secondary":null)})}),Object(r.jsx)(m.s,{modifiers:["medium","regular"],children:x.likes}),g?Object(r.jsx)(J.c,{}):Object(r.jsx)(m.a,{modifiers:["".concat(A?"disable":"primary")],className:"video__subscribebtn",onClick:O?R(A?function(){return S({channelId:x.channel._id})}:function(){return C({channel:x.channel._id})}):function(){return n.push("/login")},children:"Subscribe"})]})]}),Object(r.jsxs)(m.o,{modifiers:"vertical",className:"video__info",children:[Object(r.jsxs)(m.o.Item,{flexy:"center",mb:"0.5rem",children:[Object(r.jsx)(m.m,{as:s.b,flexwidth:"5",mr:"1rem",to:"/channel/".concat(x.channel._id),children:Object(r.jsx)(m.j,{children:Object(r.jsx)(m.i,{modifiers:"round",src:x.channel.image,alt:"Author image"})})}),Object(r.jsxs)("div",{children:[Object(r.jsx)(m.t,{as:"h2",modifiers:"regular",children:x.channel.title}),Object(r.jsxs)(m.s,{modifiers:"medium",children:[x.channel.subscribes," subscribers"]})]})]}),Object(r.jsxs)(m.o.Item,{children:[q?Object(r.jsx)(m.q,{modifiers:"small",children:x.description}):null,Object(r.jsx)(m.a,{modifiers:["medium","transparent"],onClick:function(){return E(!q)},children:q?"Show Less":"Show More"})]})]}),Object(r.jsx)(U,{})]})}):void 0}))(z(),O.e.tabport("\n      width: 90%;\n      "),O.e.tabport("\n      height: 45vw;\n      "))}}]);
//# sourceMappingURL=7.dd123519.chunk.js.map